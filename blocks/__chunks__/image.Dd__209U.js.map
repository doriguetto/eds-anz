{"version":3,"file":"image.Dd__209U.js","sources":["../../src/blocks/hero/image.tsx"],"sourcesContent":["import {useEffect, useState} from \"react\";\n\nexport type ImageBreakpoint = {\n    media?: string;\n    width: string;\n};\n\nexport type ImageSource = {\n    type: string;\n    srcSet: string;\n    media?: string;\n};\n\nexport type ImagePreloaderProps = {\n    breakpoints?: ImageBreakpoint[];\n    pictureEl: HTMLPictureElement | null | undefined,\n    lazy?: boolean;\n    preload?: boolean;\n    ext?: string;\n};\n\nconst ImagePreloader = ({breakpoints = [], lazy = false, preload = false, pictureEl, ext = 'webp'}: ImagePreloaderProps) => {\n    const [sources, setSources] = useState<ImageSource[]>([]);\n    if (!pictureEl) return null;\n    const img = pictureEl.querySelector('img')\n    const imgElSrc = img?.getAttribute('src')\n\n    if (!imgElSrc) return null;\n    const alt = img?.getAttribute('alt') || '';\n    const width = img?.getAttribute('width') || 0;\n    const height = img?.getAttribute('height') || 0;\n\n    const url = new URL(imgElSrc, window.location.href);\n    const { pathname} = url;\n    const pathWithoutExtension = pathname.substring(0,pathname.lastIndexOf('.') );\n    const imgSrc = `${pathWithoutExtension}.${ext}?width=2048&amp;format=jpeg&amp;optimize=medium`\n\n    useEffect(() => {\n\n        setSources(breakpoints.map((breakpoint) => {\n            const srcSet = `${pathname}?width=${breakpoint.width}&format=webply&optimize=medium`\n            return {\n                type: 'image/webp',\n                srcSet: srcSet,\n                media: breakpoint.media\n            }\n        }))\n    }, []);\n\n    return (\n        <>\n            {preload && (\n                <>\n                    {sources.map((source, index) => (\n                        <link rel=\"preload\" as=\"image\" href={source.srcSet} key={index}></link>\n                    ))}\n                    <link rel=\"preload\" as=\"image\" href={imgSrc}></link>\n                </>\n            )}\n            <picture>\n                {sources.map((source, index) => (\n                    <>\n                        <source key={index} media={source.media} srcSet={source.srcSet}/>\n                        <source key={index} media={source.media} type={source.type} srcSet={source.srcSet}/>\n                    </>\n                ))}\n                <img\n                    loading={lazy ? 'lazy' : 'eager'}\n                    alt={alt}\n                    width={width}\n                    height={height}\n                    src={imgSrc}\n                />\n            </picture>\n        </>\n    );\n};\n\nexport default ImagePreloader;"],"names":["ImagePreloader","breakpoints","lazy","preload","pictureEl","ext","sources","setSources","useState","img","imgElSrc","alt","width","height","url","pathname","imgSrc","useEffect","breakpoint","jsxs","Fragment","source","index","jsx"],"mappings":"gDAqBA,MAAMA,EAAiB,CAAC,CAAC,YAAAC,EAAc,CAAA,EAAI,KAAAC,EAAO,GAAO,QAAAC,EAAU,GAAO,UAAAC,EAAW,IAAAC,EAAM,UAAiC,CACxH,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAA,SAAwB,CAAE,CAAA,EACpD,GAAA,CAACJ,EAAkB,OAAA,KACjB,MAAAK,EAAML,EAAU,cAAc,KAAK,EACnCM,EAAWD,GAAA,YAAAA,EAAK,aAAa,OAE/B,GAAA,CAACC,EAAiB,OAAA,KACtB,MAAMC,GAAMF,GAAA,YAAAA,EAAK,aAAa,SAAU,GAClCG,GAAQH,GAAA,YAAAA,EAAK,aAAa,WAAY,EACtCI,GAASJ,GAAA,YAAAA,EAAK,aAAa,YAAa,EAExCK,EAAM,IAAI,IAAIJ,EAAU,OAAO,SAAS,IAAI,EAC5C,CAAE,SAAAK,CAAY,EAAAD,EAEdE,EAAS,GADcD,EAAS,UAAU,EAAEA,EAAS,YAAY,GAAG,CAAE,CACtC,IAAIV,CAAG,kDAE7CY,OAAAA,EAAAA,UAAU,IAAM,CAEDV,EAAAN,EAAY,IAAKiB,IAEjB,CACH,KAAM,aACN,OAHW,GAAGH,CAAQ,UAAUG,EAAW,KAAK,iCAIhD,MAAOA,EAAW,KAAA,EAEzB,CAAC,CACN,EAAG,CAAE,CAAA,EAIIC,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAAjB,GAEQgB,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAAd,EAAQ,IAAI,CAACe,EAAQC,UACjB,OAAK,CAAA,IAAI,UAAU,GAAG,QAAQ,KAAMD,EAAO,MAAA,EAAaC,CAAO,CACnE,QACA,OAAK,CAAA,IAAI,UAAU,GAAG,QAAQ,KAAMN,EAAQ,CAAA,EACjD,SAEH,UACI,CAAA,SAAA,CAAAV,EAAQ,IAAI,CAACe,EAAQC,IAEdH,OAAAC,EAAAA,SAAA,CAAA,SAAA,CAAAG,MAAC,UAAmB,MAAOF,EAAO,MAAO,OAAQA,EAAO,QAA3CC,CAAkD,EAC/DC,EAAAA,IAAC,SAAmB,CAAA,MAAOF,EAAO,MAAO,KAAMA,EAAO,KAAM,OAAQA,EAAO,MAAA,EAA9DC,CAAqE,CAAA,CAAA,CACtF,CACH,EACDC,EAAA,IAAC,MAAA,CACG,QAASrB,EAAO,OAAS,QACzB,IAAAS,EACA,MAAAC,EACA,OAAAC,EACA,IAAKG,CAAA,CACT,CAAA,EACJ,CACJ,CAAA,CAAA,CAER"}